<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="IT_Dao">

    <resultMap type="Movie" id="Movie">
        <result column="mo_number" property="mo_number"/>
        <result column="mo_title" property="mo_title"/>
        <result column="mo_director" property="mo_director"/>
        <result column="mo_actor" property="mo_actor"/>
        <result column="mo_genre" property="mo_genre"/>
        <result column="mo_age" property="mo_age"/>
        <result column="mo_playTime" property="mo_playTime"/>
        <result column="mo_openDate" property="mo_openDate"/>
        <result column="mo_recommendation" property="mo_recommendation"/>
        <result column="mo_fileName" property="mo_fileName"/>
        <collection property="seatandTime" resultMap="SeatandTime"/>
    </resultMap>

    <resultMap type="SeatandTime" id="SeatandTime">
        <result column="se_number" property="se_number"/>
        <result column="se_time" property="se_time"/>
        <result column="se_date" property="se_date"/>
        <result column="mo_number" property="mo_number"/>
        <result column="se_identify" property="se_identify"/>

    </resultMap>
    <select id="IT_FindMovieInfoDate" parameterType="int" resultMap="Movie">
        SELECT m.mo_number,
               m.mo_title,
               m.mo_director,
               m.mo_actor,
               m.mo_genre,
               m.mo_age,
               m.mo_playTime,
               m.mo_openDate,
               m.mo_recommendation,
               m.mo_fileName,
               s.se_number,
               s.se_time,
               s.se_date,
               s.se_identify
        FROM movie m
                 Left JOIN
             seatandTime s
             ON m.mo_number = s.mo_number
        where m.mo_number = #{mo_number}
    </select>

    <select id="It_SeatSelFindDate" parameterType="int" resultType="SeatandTime">

        SELECT DISTINCT se_date
        FROM seatandtime
        where mo_number = #{mo_number}
        order by se_date


    </select>
    <select id="It_SeatSelFindTime" parameterType="int" resultType="SeatandTime">

        SELECT DISTINCT se_time
        FROM seatandtime
        where mo_number = #{mo_number}
        order by se_time


    </select>
    <select id="It_SeatSelFindSeat" parameterType="SeatandTime" resultType="SeatandTime">

        SELECT *
        FROM seatandtime
        where mo_number = #{mo_number}
          and se_date = #{se_date}
          and se_time = #{se_time}
        order by se_number


    </select>
    <update id="It_SeatInfoUpdate" parameterType="SeatandTime">
        UPDATE seatandtime
        SET se_identify = #{se_identify}
        where se_number = #{se_number}
          and se_date = #{se_date}
          and se_time = #{se_time}
          and mo_number = #{mo_number}

    </update>
    <select id="It_SeatFindTime" parameterType="SeatandTime" resultType="SeatandTime">

        SELECT DISTINCT se_time
        FROM seatandtime
        where mo_number = #{mo_number}
          and se_date = #{se_date}
        order by se_time


    </select>


</mapper>